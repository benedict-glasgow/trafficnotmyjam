{% extends 'traffic/base.html' %}
{% load static %}

{% block topbar %}
<div id="topbar" class="contentbox">
{{ post.title }}
<div id="postnav">
	<a href="{% url 'traffic:index'">◄</a>
	<a href="{% url 'traffic:index'">►</a>
</div>
</div>
{% endblock %}

{% block left_body_block %}
	<div id="l-block" class="contentbox">
		<img src="{{ MEDIA_URL }}{{ post.photo }}" alt="Post Image Unavailable">
	</div>
{% endblock %}

{% block right_body_block %}
	<div id="r-block" class="contentbox">
		<div id="map">
			<script type="text/javascript">
				function GetMap(){
					var map = new Microsoft.Maps.Map('#map', { 
							credentials: 'AuJ09npEnmthbBSxKu6teNImwt-6ZIn83affPp-nyUTAfXypqFl12jmF_SFV0IO6',
							center: new Microsoft.Maps.Location({{ post.location }}),
							mapTypeId: Microsoft.Maps.MapTypeId.aerial,
							zoom: 10
						});

						var location = new Microsoft.Maps.Location({{ post.location }})
						var pin = new Microsoft.Maps.Pushpin( location, {
							title: '{{ post.title }}',
							});
		
						map.entities.push(pin);
				}
			</script>
			<script type='text/javascript' src='http://www.bing.com/api/maps/mapcontrol?callback=GetMap' async defer></script>
		</div>
		{{ post.location }}
	</div>
{% endblock %}

{% block bottombar%}
<div id="bottombar" class="contentbox">
	<div>
		Found at: {{ post.date }} <br/>
		Category: {{ post.category }} <br/>
		Description: {{ post.description }}<br/>
		<div>
			--RATING--<br/>
		</div>
	</div>
	
	
	<div>
	</div>
		--COMMENTS--<br/>
		{% if comments %}
		{% for comment in comments %} 
    		{{ comment.date }} <br/>
    		{{ comment.content }} <br/>
		{% endfor %}
		{% endif %}
   
	<div>
    	{% if user.is_authenticated %}
    		--MAKE COMMENTS--<br/>
    		{% if new_comment %}
        		Comment Added!
    		{% else %}
              <form id="addComments" method="post" action = ".">
                {% for hidden in commentForm.hidden_fields %}
                    {{ hidden }}
                {% endfor %}
                {% for field in commentForm.visible_fields %}
                    {{ field.errors }}
                    {{ field.help_text }}
                    {{ field }}
                {% endfor %}
               {% csrf_token %}
              <input type = "submit" value= "Post">
              </form>
            {% endif %}
        {% else %}
            Sign In Or Register To Make A Comment
        {% endif %}

	</div>

</div>
{% endblock %}